<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FIBA 3x3 Rules — MCQ Trainer (clean distractors, image signals only)</title>
<style>
  :root{
    --bg:#0e1117; --card:#141925; --ink:#e8edf2; --muted:#9aa3ad; --accent:#3874ff; --good:#10b981; --bad:#ef4444;
  }
  html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,#0d1117,#0b0e14);color:var(--ink);font:16px/1.55 system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:1100px;margin:0 auto;padding:24px}
  h1{font-weight:800;font-size:clamp(20px,2.2vw,28px);letter-spacing:.2px;margin:.2rem 0 1rem}
  .card{background:var(--card);border:1px solid rgba(255,255,255,.08);box-shadow:0 10px 30px rgba(0,0,0,.25);border-radius:16px;overflow:hidden}
  .bar{height:6px;background:#2a2f3a}
  .bar>i{display:block;height:100%;width:0;background:linear-gradient(90deg,#3874ff,#5aa3ff,#88b4ff);transition:width .4s ease}
  .q-body{padding:18px 20px 6px 20px}
  .q-meta{display:flex;justify-content:space-between;color:var(--muted);font-size:.92rem;margin-bottom:8px}
  .q-text{font-size:1.12rem;margin:6px 0 12px 0}
  .q-img{display:block;max-width:340px;max-height:340px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#0c0f15;margin:8px 0}
  .opts{display:grid;gap:10px;padding:0 20px 12px}
  .opt{display:flex;gap:10px;align-items:flex-start;background:#10141d;border:1px solid rgba(255,255,255,.09);padding:12px 12px;border-radius:12px;cursor:pointer;transition:.18s}
  .opt input{margin-top:2px}
  .opt:hover{transform:translateY(-1px);border-color:#3a4050}
  .opt.correct{border-color:rgba(16,185,129,.8);color:var(--good)}
  .opt.wrong{border-color:rgba(239,68,68,.8);color:var(--bad)}
  .footer{display:flex;gap:10px;align-items:center;padding:14px 16px;background:#121722;border-top:1px solid rgba(255,255,255,.08)}
  button{border:0;border-radius:12px;padding:11px 16px;font-weight:700;cursor:pointer}
  .ghost{color:var(--ink);background:#1a2130;border:1px solid rgba(255,255,255,.1)}
  .next{background:var(--accent);color:#fff}
  .submit{background:#0ea5e9;color:#fff}
  .hidden{display:none !important}
  .pill{display:inline-flex;align-items:center;gap:8px;background:#18202d;border:1px solid #233047;color:#bcd0ea;border-radius:100px;padding:.2rem .6rem;font-size:.8rem}
  .feedback{padding:6px 20px 14px;color:var(--muted)}
  .result{padding:22px}
  .score{font-size:1.6rem;font-weight:800;margin:0 0 10px 0}
  .answersheet{padding:10px 14px 24px}
  .answer-row{display:grid;grid-template-columns:48px 1fr;gap:12px;background:#0f1420;border:1px solid rgba(255,255,255,.08);border-radius:12px;margin:10px 0;padding:12px}
  .answer-row img{max-height:140px;border-radius:8px;border:1px solid rgba(255,255,255,.08)}
  .good{color:var(--good)} .bad{color:var(--bad)} .muted{color:var(--muted)} .small{font-size:.85rem}
</style>
</head>
<body>
<div class="wrap">
  <h1>FIBA 3x3 Rules — Interactive MCQ Practice</h1>

  <div class="card" id="quiz">
    <div class="bar"><i id="progress"></i></div>
    <div class="q-body">
      <div class="q-meta">
        <div id="qcount" class="pill">Question 1</div>
        <div class="pill"><span id="category">General</span></div>
      </div>
      <div id="qtext" class="q-text">Loading…</div>
      <img id="qimg" class="q-img hidden" alt="Referee signal"/>
    </div>
    <div id="options" class="opts"></div>
    <div id="feedback" class="feedback"></div>
    <div class="footer">
      <button id="back" class="ghost" title="Go to previous question">Back</button>
      <button id="next" class="next">Next</button>
      <button id="submit" class="submit hidden">Finish & Summary</button>
      <div style="margin-left:auto" class="muted small">Answers show immediately; progress is saved.</div>
    </div>
  </div>

  <div id="results" class="card hidden">
    <div class="result">
      <p class="score" id="scoreline">Score: —</p>
      <div class="answersheet" id="answerKey"></div>
    </div>
  </div>
</div>

<script>
/* ============================================================
   Helpers
   ============================================================ */
const shuffle = a => { for (let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a; };
const uniqBy = (arr, keyFn) => { const out=[], seen=new Set(); for(const x of arr){const k=keyFn(x); if(!seen.has(k)){seen.add(k); out.push(x);}} return out; };

/* ============================================================
   Referee SIGNALS — image items (answers are exact file names)
   ============================================================ */
const signalFiles = [
  "1. Stop the clock.jpeg","2. Stop the clock for foul.jpeg","3. 1 Point.jpeg","4. 2 points.jpeg",
  "5. Charged time-out.jpeg","6. TV time-out.jpeg","7. Cancel score, cancel play.jpeg","8. Visible count.jpeg",
  "9. Communication.jpeg","10. Shot clock reset.jpeg","11. Out-of-bounds.jpeg","12. Held ball:jump ball situation.jpeg",
  "13. Travelling.jpeg","14. Illegal Dribble_Double dribbling.jpeg","15. Illegal dribble_Carrying the ball.jpeg",
  "16. 3 seconds.jpeg","17. 5 seconds.jpeg","18. 12 seconds.jpeg","19. Deliberate kick or block of the ball.jpeg",
  "20. Ball not cleared.jpeg","31. Holding.jpeg","32. Blocking (defense)_Illegal screen (offense).jpeg",
  "33. Pushing or charging without the ball.jpeg","34. Handchecking.jpeg","35. Illegal use of hands.jpeg",
  "36. Charging with the ball.jpeg","37. Illegal contact to the hand.jpeg","38. Hooking.jpeg",
  "39. Excessive swinging of the elbow.jpeg","40. Hit to the head.jpeg","41. Foul by team in control of the ball.jpeg",
  "42. Foul on the act of shooting.jpeg","43. Foul not on the act of shooting.jpeg","44. Double foul.jpeg",
  "45. Technical foul.jpeg","46. Unsportsmanlike foul.jpeg","47. Disqualifying foul.jpeg",
  "48. Fake a foul.jpeg","49. IRS review.jpeg","50. Challenge.jpeg",
  "51. After foul without free throw(s).jpeg","52. After foul by team in control of the ball.jpeg",
  "53. 1 free throw.jpeg","54. 2 free throws.jpeg","55. 1 free throw.jpeg","56. 2 free throws.jpeg"
];
const labelFromFile = f => f.replace(/^\s*\d+\.\s*/,'').replace(/\.(jpeg|jpg|png)$/i,'');
function buildSignalQuestions(){
  const labels = signalFiles.map(labelFromFile);
  return signalFiles.map((file, idx) => {
    const correct = labels[idx];
    const wrongs = shuffle(labels.filter((_,i)=>i!==idx)).slice(0,3);
    const options = shuffle([correct, ...wrongs]); // always 4
    return {
      id:`SIG::${file}`, type:"image", cat:"Referee signals",
      q:"What does this referee signal indicate?",
      img:file, options, answer: options.indexOf(correct),
      rationale:`Signal meaning: ${correct}.`
    };
  });
}

/* ============================================================
   TEXT QUESTIONS (no diagram references; 4 options; clean distractors)
   ============================================================ */
const TEXT_QS = [
  // PLAYING COURT & LINES (no diagrams named)
  {
    q:"What are the official court dimensions for 3x3?",
    cat:"Playing court",
    options:[
      "15 m wide and 11 m long measured from the inner edge of the boundary line",
      "14 m wide and 12 m long measured from the outer edge of the boundary line",
      "15 m wide and 15 m long measured from the centre line",
      "11 m wide and 15 m long measured from the outer edge of the boundary line"
    ], answer:0
  },
  {
    q:"Which court features must exist in addition to normal lines on a 3x3 court?",
    cat:"Playing court",
    options:[
      "A free-throw line (5.80 m), a 2-point line (6.75 m), and a no-charge semi-circle area",
      "A 3-point line (7.25 m), restricted arc, and coach's box",
      "A centre circle, jump-circle markers, and lane space markers",
      "A midcourt throw-in spot, trapezoid lane, and hash marks"
    ], answer:0
  },
  {
    q:"What is true about the boundary lines in 3x3?",
    cat:"Boundary",
    options:[
      "They limit the playing court but are not part of the playing court",
      "They limit the playing court and are considered part of the playing area",
      "Only sidelines are out-of-bounds; endlines are inbounds",
      "Only the baseline is considered out-of-bounds"
    ], answer:0
  },
  {
    q:"What width and visibility are required for court lines?",
    cat:"Lines",
    options:[
      "Same colour, 5 cm wide, clearly visible in white or other contrasting colour",
      "Variable colour, 3 cm wide, lightly visible",
      "Any colour, 10 cm wide, with reflective paint",
      "Black only, 2.5 cm wide, matte finish"
    ], answer:0
  },
  {
    q:"How much additional boundary area must surround the court?",
    cat:"Boundary area",
    options:[
      "1 m at endline, 1.5 m at sidelines (minimum 1 m if space limited), and 2 m at baseline",
      "0.5 m at all sides",
      "2 m at every side with no exceptions",
      "1 m at sidelines only"
    ], answer:0
  },
  {
    q:"Where must the scorer's table be placed?",
    cat:"Table location",
    options:[
      "Behind the endline on the left-hand side when facing the basket",
      "Centred at midcourt opposite the basket",
      "Behind the baseline on the right-hand side when facing the basket",
      "On the sideline near the team benches"
    ], answer:0
  },
  {
    q:"How is the free-throw line positioned?",
    cat:"Free-throw line",
    options:[
      "Parallel to the baseline with its far edge 5.80 m from the inner edge of the baseline and 3.60 m long",
      "On the centre circle, 4.60 m from the baseline and 4.00 m long",
      "At midcourt, 6.75 m from the baseline and 3.00 m long",
      "Parallel to the sideline, 5.80 m from the sideline and 3.60 m long"
    ], answer:0
  },
  {
    q:"Which statement about the restricted area is correct?",
    cat:"Restricted area",
    options:[
      "It is bounded by the baseline, extended free-throw line, and lines 2.45 m from the mid-point of the baseline; these lines (except the baseline) are part of the restricted area",
      "It is a semicircle of radius 2.45 m and the baseline counts as part of it",
      "It is any painted area where post play occurs and lines are not part of it",
      "It is only the semi-circle under the basket with radius 1.25 m"
    ], answer:0
  },
  {
    q:"Which statement defines the 2-point field goal area?",
    cat:"Scoring areas",
    options:[
      "All of the playing court except the area inside the arc",
      "Only the arc and the area beyond the sideline",
      "Only the area inside the arc",
      "Only from the midcourt line to the arc"
    ], answer:0
  },
  {
    q:"What is the radius of the 2-point arc in 3x3?",
    cat:"Scoring areas",
    options:[
      "6.75 m measured to the outer edge of the arc from a point below the basket centre",
      "7.24 m measured to the inner edge of the arc from the backboard",
      "6.25 m measured to the inner edge from the free-throw line",
      "6.75 m measured from the sideline intersection"
    ], answer:0
  },
  {
    q:"Which is true about the 2-point line itself?",
    cat:"Scoring areas",
    options:[
      "The 2-point line (arc) is not part of the 2-point field goal area",
      "The 2-point line counts as part of the 2-point area",
      "Shots with a foot on the arc are worth 2 points",
      "The arc is part of the restricted area"
    ], answer:0
  },
  {
    q:"What best describes the no-charge semi-circle under the basket?",
    cat:"No-charge semi-circle",
    options:[
      "Radius 1.25 m to the inner edge; the semi-circle line is part of the area",
      "Radius 1.50 m to the outer edge; the line is not part of the area",
      "Radius 1.00 m to the inner edge; the line is not part of the area",
      "Radius 1.25 m to the outer edge; the line is not part of the area"
    ], answer:0
  },

  // EQUIPMENT / TEAMS
  {
    q:"Which items are required to conduct a 3x3 game?",
    cat:"Equipment",
    options:[
      "Backstop unit, game clock, scoreboard, shot clock, separate signals for scorer/timer and shot-clock operator",
      "Two backboards, bench horns, centre-jump beacon, rotating shot lights",
      "Backstop unit and game clock only",
      "Only a ball and a hoop"
    ], answer:0
  },
  {
    q:"How many players make up a 3x3 team?",
    cat:"Teams",
    options:[
      "Four: 3 on the court and 1 substitute",
      "Five: 3 on the court and 2 substitutes",
      "Three: no substitutes allowed",
      "Six: rolling substitutions"
    ], answer:0
  },
  {
    q:"Which coaching restriction applies in 3x3?",
    cat:"Teams",
    options:[
      "Coaches on the court, on the substitute seats, or coaching remotely from outside the court are not allowed",
      "Only head coaches may stand on the court during live play",
      "Assistant coaches may coach from the endline only",
      "Remote coaching by headset is allowed"
    ], answer:0
  },
  {
    q:"Which statement about team uniforms is correct?",
    cat:"Uniforms",
    options:[
      "Shirts and shorts must share the same dominant colour front and back; socks must be the same dominant colour for all team members",
      "Shirts may be any colour if shorts are black; sock colour is unrestricted",
      "Each player must wear alternate-colour sleeves to match the ball",
      "Only shirts need to match; shorts and socks may vary"
    ], answer:0
  },
  {
    q:"What numbers may be used on shirts in 3x3?",
    cat:"Uniforms",
    options:[
      "0, 00 and 1–99; no duplicate numbers on a team",
      "1–15 only; duplicates permitted",
      "0–9 only; duplicates permitted if colours differ",
      "Any three-digit number"
    ], answer:0
  },
  {
    q:"Which accessory policy is correct?",
    cat:"Other equipment",
    options:[
      "Hair accessories and jewellery are not permitted; compression sleeves and properly designed headgear are permitted",
      "All jewellery is allowed if taped; headgear is prohibited",
      "Compression sleeves are prohibited; jewellery is allowed",
      "Only team-coloured jewellery is allowed"
    ], answer:0
  },
  {
    q:"What is required when a player is bleeding?",
    cat:"Injury",
    options:[
      "He must be substituted and may return only after bleeding has stopped and the area is securely covered",
      "Play continues if the bleeding is minor",
      "A time-out is automatically granted to treat bleeding",
      "The opposing team chooses whether he must be substituted"
    ], answer:0
  },

  // PLAYING REGULATIONS
  {
    q:"What is the regular playing time in official 3x3 competitions?",
    cat:"Timing",
    options:[
      "One period of 10 minutes with the clock stopped on dead balls and free throws",
      "Two periods of 5 minutes with a running clock",
      "Four periods of 5 minutes with clock stops only in the last minute",
      "One period of 12 minutes with a running clock"
    ], answer:0
  },
  {
    q:"How is the winner determined in overtime?",
    cat:"Overtime",
    options:[
      "First team to score 2 points in overtime wins",
      "First team to lead by 2 points in overtime wins",
      "Overtime is a 5-minute period; highest score wins",
      "Overtime ends after one possession each"
    ], answer:0
  },
  {
    q:"Which statement about starting possessions is correct?",
    cat:"Start",
    options:[
      "A coin flip decides the initial possession; the winner may choose to start either the game or a potential overtime",
      "The visiting team always starts with the ball",
      "The home team chooses whether to start or defend",
      "Referees assign first possession at random"
    ], answer:0
  },
  {
    q:"When does the game start and end in regulation?",
    cat:"Timing",
    options:[
      "Starts when the ball is in the offensive player's hands after the check-ball; ends at the horn or when a team reaches 21 or 22 points",
      "Starts at the horn and ends only at the horn",
      "Starts with a jump ball and ends when a team leads by two",
      "Starts when the referee tosses the ball to the defense; ends at 20 points"
    ], answer:0
  },
  {
    q:"What makes the ball live after a made basket or last free throw?",
    cat:"Status of the ball",
    options:[
      "The ball is live following each successful field goal or last free throw",
      "The ball becomes live only after a check-ball",
      "The ball is live only after crossing midcourt",
      "The ball is live only after the referee's whistle"
    ], answer:0
  },
  {
    q:"Which statement about the ball becoming dead is correct?",
    cat:"Status of the ball",
    options:[
      "It becomes dead when a referee blows the whistle while the ball is live",
      "It becomes dead whenever a pass is deflected",
      "It is dead whenever a shot hits the ring",
      "It is dead whenever the ball is dribbled in the restricted area"
    ], answer:0
  },
  {
    q:"How is a jump-ball situation resumed in 3x3?",
    cat:"Jump ball",
    options:[
      "Check-ball for the last defensive team and the shot clock resets to 12 seconds",
      "Alternating-possession arrow decides the throw-in",
      "A traditional centre jump is used",
      "Coin flip determines possession"
    ], answer:0
  },

  // FUNDAMENTALS
  {
    q:"Which action is illegal under 'How the ball is played'?",
    cat:"Ball play",
    options:[
      "Running with the ball or deliberately kicking or blocking it with the leg",
      "Passing, tapping, rolling or dribbling the ball",
      "Throwing the ball against the backboard and regaining control",
      "Tapping a pass to a teammate"
    ], answer:0
  },
  {
    q:"When does team control start and end?",
    cat:"Team control",
    options:[
      "Starts when a player holds or dribbles a live ball; ends when the opponents gain control, the ball becomes dead, or leaves the player's hands on a shot or free throw",
      "Starts only after a team crosses midcourt; ends at a turnover or foul only",
      "Starts at the check-ball and ends at a field goal",
      "Starts on a pass reception and ends on the next dribble"
    ], answer:0
  },
  {
    q:"Which describes the act of shooting?",
    cat:"Act of shooting",
    options:[
      "Begins with the continuous motion preceding release and ends when the ball leaves the hand(s) or the airborne shooter returns both feet to the floor",
      "Begins when the ball first touches the ring and ends after a rebound",
      "Begins when the dribble starts and ends when a pass is made",
      "Begins only at the top of the jump and ends on landing"
    ], answer:0
  },
  {
    q:"How many points is a successful shot worth from behind the arc?",
    cat:"Scoring",
    options:[
      "2 points",
      "1 point",
      "3 points",
      "Value depends on team fouls"
    ], answer:0
  },
  {
    q:"What happens after a made basket in 3x3?",
    cat:"Restart",
    options:[
      "The non-scoring team takes the ball directly under the basket and must clear behind the arc without a check-ball",
      "The scoring team throws in from the endline",
      "The referee administers a check-ball at the top",
      "The ball is inbounded from the sideline at midcourt"
    ], answer:0
  },
  {
    q:"Which statement about the check-ball is correct?",
    cat:"Check-ball",
    options:[
      "The defender hands or bounces the ball to the offensive player at the top behind the arc",
      "The offensive player hands the ball to the defender anywhere on the court",
      "The referee always bounces the ball to start play",
      "The check-ball is taken on the sideline nearest the foul"
    ], answer:0
  },
  {
    q:"During a check-ball, what spacing is recommended between the two players?",
    cat:"Check-ball",
    options:[
      "Approximately 1 metre",
      "No more than 0.3 metres",
      "At least 3 metres",
      "Arm's length plus a step"
    ], answer:0
  },

  // TIME-OUTS & SUBS
  {
    q:"What is the team time-out entitlement and length?",
    cat:"Time-outs",
    options:[
      "One time-out of 30 seconds per team; plus TV time-outs at 6:59 and 3:59 if used",
      "Two time-outs of 60 seconds each per team with no TV time-outs",
      "Unlimited 20-second time-outs",
      "One 60-second time-out only, no TV time-outs"
    ], answer:0
  },
  {
    q:"When can substitutions occur and how are they made?",
    cat:"Substitution",
    options:[
      "On any dead ball before a check-ball or free throw, from behind the endline without referee action",
      "Only after made baskets and from the scorer's table",
      "At any time while the ball is live",
      "Only during time-outs with referee beckoning"
    ], answer:0
  },

  // VIOLATIONS / CLOCK
  {
    q:"How long may an offensive player remain in the restricted area?",
    cat:"3 seconds",
    options:[
      "No more than 3 consecutive seconds while his team controls a live ball and the game clock is running",
      "No more than 5 seconds regardless of control",
      "As long as he is posting up",
      "There is no restriction in 3x3"
    ], answer:0
  },
  {
    q:"What is required of a closely-guarded player holding the ball?",
    cat:"5 seconds",
    options:[
      "He must pass, shoot or dribble within 5 seconds",
      "He must shoot within 3 seconds",
      "He must pivot or pass within 4 seconds",
      "He must call a time-out"
    ], answer:0
  },
  {
    q:"What is the shot-clock duration in 3x3 and the basic requirement?",
    cat:"12 seconds",
    options:[
      "12 seconds; the ball must be released before the signal and then touch the ring or enter",
      "14 seconds; the ball must be released and hit the backboard",
      "24 seconds; only release is required",
      "10 seconds; any try counts regardless of ring contact"
    ], answer:0
  },
  {
    q:"After a defensive rebound or steal, what must the team do before attempting to score?",
    cat:"Clearing",
    options:[
      "Return the ball behind the arc by passing or dribbling",
      "Advance the ball to midcourt",
      "Call for a check-ball",
      "Attempt a shot immediately without restrictions"
    ], answer:0
  },
  {
    q:"What is the penalty if a team shoots before clearing after a change of possession?",
    cat:"Clearing",
    options:[
      "Basket is cancelled; opponents get the ball for a check-ball",
      "Two free throws to the opponents",
      "Technical foul to the shooter",
      "Play resumes with alternating-possession"
    ], answer:0
  },
  {
    q:"Which statement about goaltending/interference is correct?",
    cat:"Goal tending",
    options:[
      "Defensive goaltending awards 1 point on a free throw, 1 point on a shot from inside the arc, or 2 points from behind the arc",
      "Offensive goaltending always awards 2 points",
      "Interference is ignored if the ball is over the cylinder",
      "Defensive goaltending results in a jump ball"
    ], answer:0
  },

  // FOULS & PENALTIES
  {
    q:"What is the cylinder principle?",
    cat:"Contact",
    options:[
      "The space within an imaginary cylinder occupied by a player, including the space above him",
      "The space defined by the restricted area lines only",
      "A special area used only for post play",
      "The area outside the arc where screening occurs"
    ], answer:0
  },
  {
    q:"Which is a legal initial guarding position?",
    cat:"Guarding",
    options:[
      "Defender facing the opponent with both feet on the floor",
      "Defender with one foot on the floor and back turned",
      "Defender side-on with extended arms beyond cylinder",
      "Defender stepping into the path from behind"
    ], answer:0
  },
  {
    q:"How is charging defined in 3x3?",
    cat:"Charging",
    options:[
      "Illegal personal contact by pushing or moving into an opponent's torso",
      "Any contact by the defender while set",
      "Contact while attempting to block a shot",
      "Legal contact if the offensive player is airborne"
    ], answer:0
  },
  {
    q:"What is the interpretation inside the no-charge semi-circle?",
    cat:"No-charge",
    options:[
      "Contact caused by an airborne offensive player with a defender inside the semi-circle is not an offensive foul",
      "Any contact in the semi-circle is a defensive foul",
      "Charges cannot occur anywhere on the court",
      "Only screens are judged inside the semi-circle"
    ], answer:0
  },
  {
    q:"Which is true about team-foul penalties?",
    cat:"Team fouls",
    options:[
      "Team fouls 7–9: two free throws; Team foul 10+: two free throws and possession",
      "Team fouls 5–7: one free throw; 8+: possession only",
      "Team fouls 7–9: one free throw; 10+: one free throw and possession",
      "Only shooting fouls count toward team fouls"
    ], answer:0
  },
  {
    q:"Which is the basic penalty for a technical foul in 3x3?",
    cat:"Technical",
    options:[
      "One free throw to the opponents; it also counts as a team foul",
      "Two free throws and possession",
      "Automatic ejection of the offender",
      "No free throws; only possession"
    ], answer:0
  },
  {
    q:"What happens when a player commits his second unsportsmanlike foul?",
    cat:"Unsportsmanlike",
    options:[
      "Two free throws and possession; the player is disqualified",
      "One free throw only; the player remains in the game",
      "No free throws; ball to the opponents",
      "Team foul penalty only"
    ], answer:0
  },
  {
    q:"Which best defines a disqualifying foul?",
    cat:"Disqualifying",
    options:[
      "Any flagrant unsportsmanlike action by players or substitutes",
      "Any technical foul while arguing",
      "Any blocking foul in the restricted area",
      "Any contact during a rebound"
    ], answer:0
  },

  // FREE THROWS
  {
    q:"Which statement about free throws is correct?",
    cat:"Free throws",
    options:[
      "The shooter must release within 5 seconds and not enter or touch the line until the ball enters or touches the ring",
      "The shooter may step over the line if the ball has left his hand",
      "The shooter has 10 seconds to release the ball",
      "Players may cross the free-throw line on release"
    ], answer:0
  },
  {
    q:"Where must players not occupying rebound spaces stand during free throws that will be followed by another set or by a check-ball?",
    cat:"Free throws",
    options:[
      "Behind the free-throw line extended and behind the arc until the free throw ends",
      "On the sideline nearest their bench",
      "Anywhere inside the arc but outside the restricted area",
      "On the centre circle"
    ], answer:0
  },

  // OFFICIALS / TABLE
  {
    q:"Which game staff are required at the table?",
    cat:"Officials",
    options:[
      "A scorer, a scoreboard operator and a shot clock operator",
      "A timekeeper only",
      "Two scorers and two statisticians",
      "A public-address announcer and a replay technician only"
    ], answer:0
  },
  {
    q:"When does the shot clock start or restart?",
    cat:"Shot clock",
    options:[
      "When a team gains control of a live ball on the playing court or after a completed check-ball",
      "Only when the ball crosses behind the arc",
      "Only when the ball is dribbled",
      "On the referee's whistle after every pass"
    ], answer:0
  },
  {
    q:"When is the shot clock reset to 12 seconds?",
    cat:"Shot clock",
    options:[
      "When the ball legally enters the basket, after control changes on a foul or violation, after a jump-ball result, after the ball touches the ring and any team gains control, or when free throws are awarded",
      "Only after a defensive rebound",
      "Only after the ball touches the backboard",
      "At the start of each minute"
    ], answer:0
  },

  // GAME RESULTS
  {
    q:"When does a team lose by forfeit?",
    cat:"Game result",
    options:[
      "If at scheduled start time it is not on the court with 3 players ready to play",
      "If it trails by 10 points at any time",
      "If it commits 10 team fouls",
      "If it fails to score in the first 2 minutes"
    ], answer:0
  },
  {
    q:"What is a loss by default?",
    cat:"Game result",
    options:[
      "Leaving the court before the end of the game or when all players of a team are injured or disqualified",
      "Failing to win the coin flip",
      "Having fewer than 4 players on the roster",
      "Exceeding the time-out limit"
    ], answer:0
  }
];

/* ============================================================
   Assemble pool (text + signals), shuffle, no duplicates
   ============================================================ */
const POOL = shuffle(uniqBy([...TEXT_QS, ...buildSignalQuestions()], q=>q.id || q.q));
const TOTAL = POOL.length;
const RUN = { order: POOL, answers: Array(TOTAL).fill(null), i: 0, score: 0 };

/* ============================================================
   DOM bindings & rendering
   ============================================================ */
const $qtext = document.getElementById("qtext");
const $qimg  = document.getElementById("qimg");
const $opts  = document.getElementById("options");
const $next  = document.getElementById("next");
const $back  = document.getElementById("back");
const $submit= document.getElementById("submit");
const $qcount= document.getElementById("qcount");
const $cat   = document.getElementById("category");
const $prog  = document.getElementById("progress");
const $fb    = document.getElementById("feedback");

function render(i){
  const q = RUN.order[i];
  $qcount.textContent = `Question ${i+1} / ${TOTAL}`;
  $cat.textContent = q.cat || "General";
  $qtext.textContent = q.q;
  $fb.textContent = "";

  if(q.type==="image"){
    $qimg.src = q.img; $qimg.classList.remove("hidden"); $qimg.alt="Referee signal";
  } else { $qimg.classList.add("hidden"); }

  // ensure exactly 4 options, shuffled
  const options = shuffle(q.options.slice(0,4));
  q._shuffled = options;
  q.answer = options.indexOf(q.options[q.answer]); // map to new index

  $opts.innerHTML = "";
  options.forEach((opt,idx)=>{
    const div = document.createElement("label");
    div.className = "opt";
    div.innerHTML = `<input type="radio" name="q${i}"> <span>${opt}</span>`;
    div.addEventListener("click",()=>{
      if(RUN.answers[i]!=null) return; // lock after first answer
      RUN.answers[i]=idx;
      [...$opts.children].forEach((c,j)=>{
        if(j===q.answer) c.classList.add("correct");
        if(j===idx && idx!==q.answer) c.classList.add("wrong");
      });
      if(idx===q.answer) RUN.score++;
      $fb.innerHTML = `${idx===q.answer?'<span class="good"><b>Correct.</b></span>':'<span class="bad"><b>Incorrect.</b></span>'} ${q.rationale?q.rationale:''}`;
    });
    $opts.appendChild(div);
  });

  $back.disabled = i===0;
  $next.classList.toggle("hidden", i===TOTAL-1);
  $submit.classList.toggle("hidden", i!==TOTAL-1);
  $prog.style.width = `${(i)/TOTAL*100}%`;
}

document.getElementById("next").addEventListener("click", ()=>{ RUN.i=Math.min(TOTAL-1,RUN.i+1); render(RUN.i); });
document.getElementById("back").addEventListener("click", ()=>{ RUN.i=Math.max(0,RUN.i-1); render(RUN.i); });
document.getElementById("submit").addEventListener("click", finish);

function finish(){
  const container = document.getElementById("quiz");
  const results = document.getElementById("results");
  let correct = 0;
  const keyEl = document.getElementById("answerKey");
  keyEl.innerHTML = "";

  RUN.order.forEach((q,idx)=>{
    const chosen = RUN.answers[idx];
    if(chosen===q.answer) correct++;

    const row = document.createElement("div");
    row.className = "answer-row";
    const left = document.createElement("div");
    if(q.type==="image"){
      const img = document.createElement("img");
      img.src = q.img; img.alt="Referee signal";
      left.appendChild(img);
    }else{
      left.innerHTML = `<div class="pill">${q.cat||"General"}</div>`;
    }
    const right = document.createElement("div");
    const correctText = (q._shuffled||q.options)[q.answer];
    const chosenText  = chosen!=null ? (q._shuffled||q.options)[chosen] : "(no answer)";
    right.innerHTML = `
      <div><strong>Q${idx+1}.</strong> ${q.q}</div>
      <div><span class="good"><b>Correct answer:</b></span> ${correctText}</div>
      <div><span class="${chosen===q.answer?'good':'bad'}"><b>Your answer:</b></span> ${chosenText}</div>
    `;
    row.appendChild(left); row.appendChild(right);
    keyEl.appendChild(row);
  });

  document.getElementById("scoreline").textContent = `Score: ${correct} / ${TOTAL}`;
  container.classList.add("hidden");
  results.classList.remove("hidden");
  document.getElementById("progress").style.width="100%";
}

// Start
render(0);
</script>
</body>
</html>